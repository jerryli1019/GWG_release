/home/yili/.local/lib/python3.7/site-packages/pandas/compat/_optional.py:138: UserWarning: Pandas requires version '2.7.0' or newer of 'numexpr' (version '2.6.9' currently installed).
  warnings.warn(msg, UserWarning)
cuda:0
EBM(
  (net): MLPEBM_cat(
    (proj): Linear(in_features=256, out_features=4, bias=True)
    (net): Sequential(
      (0): Linear(in_features=3136, out_features=256, bias=True)
      (1): Swish()
      (2): Linear(in_features=256, out_features=256, bias=True)
      (3): Swish()
      (4): Linear(in_features=256, out_features=256, bias=True)
      (5): Swish()
      (6): Linear(in_features=256, out_features=1, bias=True)
    )
  )
)
torch.Size([1000, 784, 256])
DiffSamplerMultiDim()
  0%|          | 0/106 [00:00<?, ?it/s]  1%|          | 1/106 [00:47<1:22:58, 47.41s/it]  2%|▏         | 2/106 [00:51<38:13, 22.06s/it]    3%|▎         | 3/106 [00:56<24:20, 14.18s/it]  4%|▍         | 4/106 [01:01<17:40, 10.39s/it]  5%|▍         | 5/106 [01:05<13:55,  8.27s/it]  6%|▌         | 6/106 [01:10<11:45,  7.06s/it]  7%|▋         | 7/106 [01:14<10:10,  6.17s/it]  8%|▊         | 8/106 [01:19<09:16,  5.68s/it]  8%|▊         | 9/106 [01:23<08:38,  5.34s/it]  9%|▉         | 10/106 [01:28<08:11,  5.11s/it] 10%|█         | 11/106 [01:33<07:48,  4.93s/it] 11%|█▏        | 12/106 [01:37<07:36,  4.86s/it] 12%|█▏        | 13/106 [01:42<07:23,  4.77s/it] 13%|█▎        | 14/106 [01:46<07:12,  4.70s/it] 14%|█▍        | 15/106 [01:51<06:59,  4.61s/it] 15%|█▌        | 16/106 [01:55<06:53,  4.59s/it] 16%|█▌        | 17/106 [02:00<06:49,  4.60s/it] 17%|█▋        | 18/106 [02:04<06:41,  4.57s/it] 18%|█▊        | 19/106 [02:09<06:37,  4.57s/it] 19%|█▉        | 20/106 [02:14<06:33,  4.58s/it] 20%|█▉        | 21/106 [02:18<06:26,  4.55s/it] 21%|██        | 22/106 [02:23<06:22,  4.56s/it] 22%|██▏       | 23/106 [02:27<06:17,  4.55s/it] 23%|██▎       | 24/106 [02:32<06:08,  4.49s/it] 24%|██▎       | 25/106 [02:36<06:06,  4.53s/it] 25%|██▍       | 26/106 [02:41<06:06,  4.58s/it] 25%|██▌       | 27/106 [02:45<06:03,  4.60s/it] 26%|██▋       | 28/106 [02:50<05:54,  4.54s/it] 27%|██▋       | 29/106 [02:54<05:51,  4.56s/it] 28%|██▊       | 30/106 [02:59<05:42,  4.50s/it] 29%|██▉       | 31/106 [03:04<05:41,  4.55s/it] 30%|███       | 32/106 [03:08<05:37,  4.56s/it] 31%|███       | 33/106 [03:13<05:33,  4.56s/it] 32%|███▏      | 34/106 [03:17<05:28,  4.57s/it] 33%|███▎      | 35/106 [03:22<05:24,  4.58s/it] 34%|███▍      | 36/106 [03:26<05:16,  4.52s/it] 35%|███▍      | 37/106 [03:31<05:13,  4.54s/it] 36%|███▌      | 38/106 [03:36<05:11,  4.58s/it] 37%|███▋      | 39/106 [03:40<05:04,  4.55s/it] 38%|███▊      | 40/106 [03:45<05:03,  4.60s/it] 39%|███▊      | 41/106 [03:49<04:56,  4.55s/it] 40%|███▉      | 42/106 [03:54<04:52,  4.57s/it] 41%|████      | 43/106 [03:58<04:49,  4.60s/it] 42%|████▏     | 44/106 [04:03<04:43,  4.57s/it] 42%|████▏     | 45/106 [04:08<04:39,  4.58s/it] 43%|████▎     | 46/106 [04:12<04:33,  4.55s/it] 44%|████▍     | 47/106 [04:16<04:27,  4.53s/it] 45%|████▌     | 48/106 [04:21<04:23,  4.54s/it] 46%|████▌     | 49/106 [04:26<04:20,  4.56s/it] 47%|████▋     | 50/106 [04:30<04:14,  4.54s/it] 48%|████▊     | 51/106 [04:35<04:09,  4.53s/it] 49%|████▉     | 52/106 [04:39<04:06,  4.57s/it] 50%|█████     | 53/106 [04:44<04:01,  4.56s/it] 51%|█████     | 54/106 [04:48<03:55,  4.52s/it] 51%|█████     | 54/106 [04:51<04:40,  5.40s/it]
(0) | cur lr = 0.0010 |log p(real) = 0.0460, log p(fake) = 0.0460, diff = -0.0000, hops = 2.0000
#############PLOT BUFFER#############
Traceback (most recent call last):
  File "pcd_ebm_ema_cat.py", line 295, in <module>
    main(args)
  File "pcd_ebm_ema_cat.py", line 180, in main
    x_fake_new = sampler.step(x_fake.detach(), model).detach()
  File "/nadata/cnl/home/yili/jerry-li/GWG_release/samplers.py", line 58, in step
    a_s.append(a.mean().item())
KeyboardInterrupt
